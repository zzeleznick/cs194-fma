<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Face Morphing</title>
    <meta name="author" content="Zachary Zeleznick">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    
    
    
    
    

    <link rel="stylesheet" type="text/css" href= http://0.0.0.0:4000/stylesheets/normalize.css  media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href= http://0.0.0.0:4000/stylesheets/stylesheet.css  media="screen">
    <link rel="stylesheet" type="text/css" href= http://0.0.0.0:4000/stylesheets/github-light.css  media="screen">
    <link rel="stylesheet" type="text/css" href= http://0.0.0.0:4000/stylesheets/grid.css  media="screen">
    <!--link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css"-->
    <script type="text/javascript" src=http://0.0.0.0:4000/javascripts/scale.fix.js></script>
    <script type="text/javascript" src=http://0.0.0.0:4000/javascripts/salvattore.js></script>

</head>
<body>

    <section class="page-header-small">
      <h1 class="project-name"><a href= "http://zzeleznick.github.io/cs194-fma"> CS194-ZZ </a></h1>
      <h2 class="project-tagline">Face Morphing</h2>
      <h3 class="project-subline">Warping, Averaging, and Caricatures</h2>
    </section>

<div id="post">
    <section class="main-content">
        <h2 class="anchor" id="main"><span class="octicon octicon-link">I. Introduction</span></h2>
Here, we will explore the beauty of determining facial features, triangulation, and morphing in great detail. Shape and symmetry of individual faces enable us to distinguish identities, and we will see how to morph someone’s face into someone else's face, compute the average face of a population, and extrapolate from a population mean to create a caricature.
<h4> Brief Overview of Key Challenges </h4>
<p>1) Mapping correspondence of features between faces</p>
<p>2) Determining the affine transformation matrix to warp one face to another</p>
<p>3) Ensuring consistency between feature space labeling and dimensions</p>
<h2>  II. Defining Correspondences </h2>
<p>Distinctive features such as eyes and eyebrows, lips and nose, ears and chin, are important to preserve — and act as the key areas of interest to morph between faces. In this project, I used the
 <code> ginput </code> function from <code> matplotlib.pyplot</code>. I then selected n points [30-40] for faces A,B, selecting each pair of corresponding point side-by-side.
</p>
<h3> Triangulation Here&#8230;.<sup class="footnote" id="fnr1"><a href="#fn1">1</a></sup> </h3>
<h2 class="center"> <span class="caps">III</span>. Face Morphs </h2>
<div class="pure-g">
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/morphs/Paris.jpg"><img src="http://0.0.0.0:4000/images/p5/morphs/Paris.jpg" title="Paris Hilton" alt="Paris Hilton" /></a><br />
         Paris Hilton<br />
       <br><br>    </div>
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/morphs/ParisBrad.gif"><img src="http://0.0.0.0:4000/images/p5/morphs/ParisBrad.gif" title="Bradis" alt="Bradis" /></a><br />
         Bradis<br />
       <br><br>    </div>
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/morphs/Brad.jpg"><img src="http://0.0.0.0:4000/images/p5/morphs/Brad.jpg" title="Brad Pitt" alt="Brad Pitt" /></a><br />
         Brad Pitt<br />
       <br><br>    </div>
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/morphs/Martin.jpg"><img src="http://0.0.0.0:4000/images/p5/morphs/Martin.jpg" title="Martin" alt="Martin" /></a><br />
         Martin<br />
       <br><br>    </div>
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/morphs/MartinGeorge.gif"><img src="http://0.0.0.0:4000/images/p5/morphs/MartinGeorge.gif" title="Geortin" alt="Geortin" /></a><br />
         Geortin<br />
       <br><br>    </div>
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/morphs/George.jpg"><img src="http://0.0.0.0:4000/images/p5/morphs/George.jpg" title="George Clooney" alt="George Clooney" /></a><br />
         George Clooney<br />
       <br><br>    </div>
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/morphs/Obama.jpg"><img src="http://0.0.0.0:4000/images/p5/morphs/Obama.jpg" title="Obama" alt="Obama" /></a><br />
         Obama<br />
       <br><br>    </div>
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/morphs/ObamaKobe.gif"><img src="http://0.0.0.0:4000/images/p5/morphs/ObamaKobe.gif" title="Kobama" alt="Kobama" /></a><br />
         Kobama<br />
       <br><br>    </div>
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/morphs/Kobe.jpg"><img src="http://0.0.0.0:4000/images/p5/morphs/Kobe.jpg" title="Kobe" alt="Kobe" /></a><br />
         Kobe<br />
       <br><br>    </div>
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/morphs/Woz.jpg"><img src="http://0.0.0.0:4000/images/p5/morphs/Woz.jpg" title="Woz" alt="Woz" /></a><br />
         Woz<br />
       <br><br>    </div>
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/morphs/StevenWoz.gif"><img src="http://0.0.0.0:4000/images/p5/morphs/StevenWoz.gif" title="Wobuccini" alt="Wobuccini" /></a><br />
         Wobuccini<br />
       <br><br>    </div>
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/morphs/Steven.jpg"><img src="http://0.0.0.0:4000/images/p5/morphs/Steven.jpg" title="Buccini" alt="Buccini" /></a><br />
         Buccini<br />
       <br><br>    </div>
</div>
<p></notextile></p>
<p><!--script src="https://gist.github.com/zzeleznick/bfb5a0c9c3a53d0bfdd6.js"></script--></p>
<h2 class="center"> IV. Average Faces </h2>
<div class="pure-g">
    <div class="pure-u-1-4 pure-u-md-1-2 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/midway/ParisBrad.jpg"><img src="http://0.0.0.0:4000/images/p5/midway/ParisBrad.jpg" title="Bradis" alt="Bradis" /></a><br />
         Bradis<br />
       <br><br>    </div>
    <div class="pure-u-1-4 pure-u-md-1-2 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/midway/MartinGeorge.jpg"><img src="http://0.0.0.0:4000/images/p5/midway/MartinGeorge.jpg" title="Geortin" alt="Geortin" /></a><br />
         Geortin<br />
       <br><br>    </div>
    <div class="pure-u-1-4 pure-u-md-1-2 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/midway/ObamaKobe.jpg"><img src="http://0.0.0.0:4000/images/p5/midway/ObamaKobe.jpg" title="Kobama" alt="Kobama" /></a><br />
         Kobama<br />
       <br><br>    </div>
    <div class="pure-u-1-4 pure-u-md-1-2 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/midway/StevenWoz.jpg"><img src="http://0.0.0.0:4000/images/p5/midway/StevenWoz.jpg" title="Wobuccini" alt="Wobuccini" /></a><br />
         Wobuccini<br />
       <br><br>    </div>
</div>
<p>For each of the input images above, each pair of faces was morphed to the midway shape and then cross disolved to simulate the average of the two faces.
 <br> <br></p>
<h2 class="center"> V. Population Average Faces </h2>
<div class="pure-g">
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/popAve/AveMResult.jpg"><img src="http://0.0.0.0:4000/images/p5/popAve/AveMResult.jpg" title="Danish Male" alt="Danish Male" /></a><br />
         Danish Male<br />
       <br><br>    </div>
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/popAve/AveDane.gif"><img src="http://0.0.0.0:4000/images/p5/popAve/AveDane.gif" title="Joe Dane" alt="Joe Dane" /></a><br />
         Joe Dane<br />
       <br><br>    </div>
    <div class="pure-u-1-3 pure-u-md-1-3 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/popAve/AveFResult.jpg"><img src="http://0.0.0.0:4000/images/p5/popAve/AveFResult.jpg" title="Danish Female" alt="Danish Female" /></a><br />
         Danish Female<br />
       <br><br>    </div>
</div>
<div class="pure-g">
    <div class="pure-u-1-4 pure-u-md-1-2 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/popAve/AveMToZHalf.jpg"><img src="http://0.0.0.0:4000/images/p5/popAve/AveMToZHalf.jpg" title="Danish to Half Zach" alt="Danish to Half Zach" /></a><br />
         Danish to Half Zach<br />
       <br><br>    </div>
    <div class="pure-u-1-4 pure-u-md-1-2 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/popAve/AveMToZ.jpg"><img src="http://0.0.0.0:4000/images/p5/popAve/AveMToZ.jpg" title="Danish to Zach" alt="Danish to Zach" /></a><br />
         Danish to Zach<br />
       <br><br>    </div>
    <div class="pure-u-1-4 pure-u-md-1-2 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/popAve/ZToAveMHalf.jpg"><img src="http://0.0.0.0:4000/images/p5/popAve/ZToAveMHalf.jpg" title="Zach to Half Danish" alt="Zach to Half Danish" /></a><br />
         Zach to Half Danish<br />
       <br><br>    </div>
    <div class="pure-u-1-4 pure-u-md-1-2 center"> <a href="http://zzeleznick.github.io/cs194-fma/images/p5/popAve/ZToAveM.jpg"><img src="http://0.0.0.0:4000/images/p5/popAve/ZToAveM.jpg" title="Zach to Danish" alt="Zach to Danish" /></a><br />
         Zach to Danish<br />
       <br><br>    </div>
</div>
<h3 class='center'> IX. Failure Cases </h3>
Faces are really tough to scale down properly, especially when they fill the frame of the image.
Standard rescaling would be more appropriate in this case.
<div class="videoWrapper">
<!-- Copy & Pasted from YouTube -->
<iframe width="560" height="349" src="http://vimeo.com/143365166" frameborder="0" allowfullscreen></iframe>
</div>
<p><object width="WIDTH" height="HEIGHT"><br />
 <param name="allowfullscreen" value="true" /><br />
 <param name="allowscriptaccess" value="always" /><br />
 <param name="movie" value="https://vimeo.com/143365166&amp;server=vimeo.com&amp;autoplay=1&amp;loop=1&amp;fullscreen=1" /><br />
 <embed src="https://vimeo.com/143365166&amp;server=vimeo.com&amp;autoplay=1&amp;loop=1&amp;fullscreen=1" allowfullscreen="true" allowscriptaccess="always" width="WIDTH" height="HEIGHT"></embed><br />
 </object></p>
<h3 class="center"> 6 Lessons Learned: </h3>
<ol>
	<li>Use image objects and classes instead of passing around variables in global scope.</li>
	<li>Use small test cases and modular designs to save time.</li>
	<li>If you are doing a visual project, DO visual testing.</li>
	<li>Vectorization can speed up <code>numpy</code> routines by a factor of 10.</li>
	<li>Precomputation trades memory for speed, but is great for preloading expected user input.</li>
	<li>The best output comes from the best input.</li>
</ol>
<p><br></p>
<p class="footnote" id="fn0"><a href="#fnr0"><sup>0</sup></a> <a href="http://portal.acm.org/citation.cfm?id=1276390">Seam Carving for Content-Aware Image Resizing</a></p>
<p class="footnote" id="fn1"><a href="#fnr1"><sup>1</sup></a> While the implementation was relatively straight forward for basic functionality, speed was horrendously slow until I learned to utilize numpy vector operations such as <code>argmin</code>, <code>amin</code>, and <code>np.delete</code></p>
<p class="footnote" id="fn2"><a href="#fnr2"><sup>2</sup></a> The cumulative energy paths were based from applying an edge detection filter that mapped pixel gradients to preserve high-contrast features.</p>
<p class="footnote" id="fn3"><a href="#fnr3"><sup>3</sup></a> Storing whether the pixel was left (red), straight (yellow), or right (green) was a recomended strategy for runtime optimization, but was more helpful for crude seam visualizations.</p>
<p class="footnote" id="fn4"><a href="#fnr4"><sup>4</sup></a> This problem is akin to trying to climb up a mountain that shrinks with each step and then trying to backtrack to find your path from your starting location. While you may have finished the proccess, you have lost crucial information. The picture should show some insight on how I solved this problem, but I would be happy to explain if you&#8217;re curious.</p>
<p><!--script src="https://gist.github.com/zzeleznick/e146e30205393b4ad9ec.js"></script--></p>
<p class="footnote" id="fn6"><a href="#fnr6"><sup>6</sup></a> <a href="http://www.premiumtours.co.uk/images/product/original/181_1.jpg">Stonehenge by Day</a></p>
<p class="footnote" id="fn7"><a href="#fnr7"><sup>7</sup></a> <a href="https://www.flickr.com/photos/kate_williams/3229244633/">Stonehenge during Lightning Strike</a></p>
<p class="footnote" id="fn8"><a href="#fnr8"><sup>8</sup></a> <a href="http://i.telegraph.co.uk/multimedia/archive/02066/Stonehenge_2066365b.jpg">Stonehenge by Mike Parker Pearson</a></p>
<p class="footnote" id="fn9"><a href="#fnr9"><sup>9</sup></a> <a href="http://www.lichtensteinfoundation.org/0278.htm">Girl with Hair Ribbon, 1965 by Roy Lichtenstein</a></p>
<p><a target="_blank" href= http://0.0.0.0:4000/p4/logs/> <h5 class="center"> See the logs produced for my test files </h5> </a></p>
<p><a target="_blank" href= http://0.0.0.0:4000/p4/docs/> <h5 class="center"> Read More about my Code </h5></a></p>
<comment>

		<ol>
			<li>A list!</li>
		</ol><p>http://redcloth.org/textile/phrase-modifiers/#links</p>
<p>I&#8217;m really excited about <a href="redcloth">RedCloth</a>.<br />
I love it so much, I think I&#8217;ll name my first child <a href="redcloth">RedCloth</a>.<br />
[redcloth]http://redcloth.org</p>
</comment>
<p><br>
<h5 class='center'>  &#8211; Zachary Zeleznick </h5></p>
    </section>
</div>

<!--div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
  </ul>
</div-->

</body>
</html>